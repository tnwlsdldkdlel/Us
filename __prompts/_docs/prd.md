# 모바일 앱 "Us" 제품 요구사항 명세서 (PRD)

## 1. 개요 (Introduction)

"Us"는 사용자가 친구들과의 약속을 손쉽게 생성하고 공유하며, 모든 약속을 캘린더를 통해 체계적으로 관리할 수 있도록 돕는 모바일 소셜 캘린더 애플리케이션이다. 본 문서는 "Us" 앱의 초기 버전(MVP) 개발을 위한 목표, 기능, 요구사항을 정의한다.

## 2. 제품 목표 (Product Goals)

- **핵심 목표**: 친구 간 약속 생성 및 관리의 번거로움을 최소화하고, 약속 이행률을 높인다.
- **사용자 목표**: 흩어져 있는 약속 정보를 한곳에서 관리하고, 친구들의 참석 여부를 실시간으로 파악한다.
- **비즈니스 목표**: 초기 사용자 확보를 통해 서비스의 시장성을 검증하고, 향후 고도화 방향을 설정한다.

## 3. 사용자 스토리 (User Stories)

- **대학생 A**: "팀 프로젝트, 스터디, 동아리 등 여러 그룹의 모임이 많다. 각 채팅방에 흩어진 약속 공지를 한눈에 확인하고 내 스케줄을 관리하고 싶다."
- **직장인 B**: "친구들과의 저녁 식사나 주말 모임을 잡을 때, 누가 오는지 일일이 물어보지 않고도 앱에서 바로 참석 인원을 파악하고 싶다."

## 4. 기능 명세 및 개발 우선순위 (Features & Priority)

### Priority 1: 핵심 MVP 기능 (출시 필수)

- **1-1. 회원가입 및 로그인**
    - 구글 계정을 통한 소셜 로그인 기능
    - 애플 계정을 통한 소셜 로그인 기능
- **1-2. 친구 관리 (기본)**
    - **이메일 주소 입력을 통한 친구 추가 요청 기능 (고도화)**
        - **요청 대상이 이미 가입한 회원이고 앱이 설치된 경우:** 이메일 대신 앱 내 푸시 알림을 발송하여 즉시 요청을 확인할 수 있도록 한다.
        - **요청 대상이 미가입 회원 또는 앱 미설치자인 경우:** Supabase Functions를 통해 친구 초대 메일을 발송한다.
            - 메일의 수락 버튼 클릭 시, 앱 설치 유무를 판단한다.
            - 앱이 미설치된 경우, 각 OS에 맞는 앱 스토어로 이동시켜 설치를 유도한다.
            - 앱이 설치된 경우, 앱을 실행하고 친구 목록 화면으로 바로 이동시킨다. (딥링크 기능)
    - 받은 친구 요청에 대한 수락 및 거절 기능
    - 친구 요청 상태는 '요청됨/수락됨/거절됨' 세 단계로 관리하며,
      - 수락 시 친구 목록에 편입되고 요청 목록에서는 제거된다.
      - 거절 시 친구·보낸 요청·받은 요청 목록 어디에도 남지 않으며, 상태 이력만 `REJECTED` 로 유지된다.
    - 거절된 요청자가 다시 요청할 경우 기존 레코드를 재사용해 상태를 `REQUESTED` 로 되돌리고 최신 요청자로 업데이트한다.
    - 가입하지 않은 친구에게 초대를 보낼 경우 `friend_invites` 테이블에 보관하며, 상태를 `INVITED` 로 표시한다.
      - 초대 메일 발송과 레코드 생성은 트랜잭션으로 처리하고, 하루 20회 초대 제한을 적용한다.
      - 14일이 지나면 초대는 자동 만료(`EXPIRED`) 처리되며 목록에서 제거된다.
      - 수신자가 가입하면 초대가 자동으로 `friendships` 의 `REQUESTED` 상태로 전환되고, 기존 초대 레코드는 `COMPLETED` 로 기록된다.
    - "보낸 요청" 탭에서 초대 상태를 `초대됨` 으로 노출하며, 취소/만료 시 목록에서 제거한다.
    - 연결된 친구 목록 및 요청 대기중인 친구 목록 조회
- **1-3. 약속 생성 및 조회**
    - 약속명, 날짜, 시간 정보를 포함한 약속 생성 기능
    - **약속 장소 지정 시, 카카오맵 API와 연동하여 장소를 검색하고 지정하는 기능**
    - 검색한 장소의 `장소명/주소/위도/경도`를 약속 레코드에 저장해 참여자가 지도에서 바로 확인할 수 있도록 한다.
    - 친구 목록에서 약속에 초대할 친구 선택 기능
    - 홈 화면에서 '오늘의 약속', '다가오는 약속' 카드 형태로 조회
    - 캘린더 화면에서 월별 약속 현황 조회
    - 약속 카드 클릭 시 지도, 참여자 정보를 포함한 상세 페이지로 이동하며 모든 참여자는 본인을 제외한 다른 참석자들의 목록과 RSVP 상태를 조회할 수 있다.
- **1-4. 참석 여부(RSVP)**
    - 약속 초대 시 기본 '미정' 상태로 설정
    - 약속 상세 페이지에서 '참석', '불참', '미정' 상태를 직접 변경하는 기능
    - 참여자 목록에 각 친구의 RSVP 상태 표시(생성자/참여자 모두 조회 가능)
    - 약속 수정/삭제 권한은 생성자에게만 부여하며, 참여자는 RSVP 변경 및 댓글 작성만 가능하다.

### Priority 2: 후속 업데이트 기능 (MVP 이후 빠른 시일 내)

- **2-1. 실시간 푸시 알림**
    - 신규 약속 초대, 약속 정보 변경/취소, 약속 시간 임박 시 알림
- **2-2. 약속 관리**
    - 약속 생성자가 약속 정보를 편집하는 기능
    - 약속 생성자가 약속을 삭제하는 기능
- **2-3. 친구 관리 (고급)**
    - 친구 목록에서 특정 친구를 삭제하는 기능
- **2-4. 소통 기능**
    - 약속 상세 페이지 내에서 참여자들 간의 댓글(게시판) 기능(참여자/생성자 모두 댓글 작성 가능, 작성자 또는 생성자만 수정/삭제)

### Priority 3: 서비스 고도화 기능 (장기적 관점)

- **3-1. 마이페이지 기능 확장**
    - 사용자 프로필 사진 및 상태 메시지 설정
    - 알림 종류별 ON/OFF 설정 기능
- **3-2. 지도 연동 강화**
    - 약속 장소 길찾기 기능 연동
- **3-3. 편의 기능**
    - 약속별 정산/비용 관리 기능
    - 반복 일정(매주/매월) 설정 기능

## 5. 비기능적 요구사항 (Non-Functional Requirements)

- **성능**: 모든 사용자 인터랙션은 0.2초 이내에 응답해야 하며, API 서버 응답 시간은 0.5초 이내를 목표로 한다.
- **보안**: 사용자 이메일 등 개인정보는 암호화하여 저장하며, API 통신은 HTTPS를 필수로 사용한다.
- **지원 플랫폼**: iOS 15.0 이상, Android 8.0 (Oreo) 이상을 지원한다.

## 6. 제외 범위 (Out of Scope for MVP)

- 태블릿 전용 UI 화면
- 오프라인 모드 지원
- 그룹 채팅 기능

## 7. 가정 및 의존성 (Assumptions & Dependencies)

- **지도**: 약속 위치 표시는 Kakao Maps SDK를 사용한다.
- **인증**: 소셜 로그인은 Google/Apple에서 제공하는 공식 SDK를 사용한다.
- **알림**: 푸시 알림은 Firebase Cloud Messaging(FCM) 및 Apple Push Notification Service(APNS)를 사용한다.

## 8. 성공 지표 (Success Metrics)

- **활성 사용자 수**: DAU (일일 활성 사용자), MAU (월간 활성 사용자)
- **핵심 기능 사용률**: 주간 신규 약속 생성 수, 친구 요청 발송 및 수락률
- **사용자 유지율**: 신규 가입자 1주, 4주 후 재방문율 (Retention)
